# CLAUDE.md
## ESKA WMS – Local Development Instructions

이 문서는 Claude Code가 이 레포(repo/wms)에서 작업할 때
항상 따라야 할 **기본 규칙(헌법)**이다.
현재 기준은 **로컬 개발 및 기능 검증 환경**이다.

---

## 1. 기본 커뮤니케이션 규칙

- 모든 설명과 답변은 **한국어**로 한다.
- 사용자는 실무 중심 개발자이며, 장황한 이론 설명을 원하지 않는다.
- "왜 문제인지 / 실무에서 어떤 문제가 생기는지"를 중심으로 설명한다.
- 추상적인 아키텍처 토론보다 **현재 코드 기준 판단**을 우선한다.

---

## 2. 코드 수정 및 제안 규칙 (중요)

- **코드 수정 시 코드를 절대 출력하지 않는다.**
  - 코드 블록 출력 ❌ (수정 전/후 코드 모두 포함)
  - 코드 예시, 코드 조각 출력 ❌
  - Edit/Write 도구로 직접 파일 수정 ⭕
- 수정 완료 후 아래 항목만 간단히 보고:
  1. 변경된 파일 목록 (표 형태)
  2. 변경 내용 요약 (1~2줄, 코드 없이 텍스트로만)
  3. 주의사항 (있을 경우만)

---

## 3. 프로젝트 구조 인식

- 레포 루트: `repo/wms`

### 3.1 Desktop (핵심)
- 경로: `apps/wms-desktop`
- 기술: Electron + React
- 역할:
  - 바코드/스캔 기반 입고(Inbound)
  - 출고(Outbound)
  - UNDO(직전/연속/전체 취소)
  - 비프음/경고/실무 UX

### 3.2 Backend
- 경로: `services/core-api`
- 기술: NestJS + Prisma
- DB:
  - 현재 기준: **로컬 환경(Postgres 또는 SQLite)**
  - 스키마 정합성, 트랜잭션 로직이 중요

### 3.3 Web
- 경로: `apps/web`
- 현재 비중 낮음
- WMS 핵심 판단에는 포함하지 않아도 됨

---

## 4. WMS 실무 기준 (로컬 기준)

Claude는 항상 **실제 창고 작업 흐름**을 기준으로 판단해야 한다.

### 4.1 우선순위
1. Inbound / Outbound 스캔 흐름 안정성
2. Inventory / InventoryTx 수량 정합성
3. UNDO 로직의 안전성
4. 중복 스캔, 잘못된 스캔 시 되돌릴 수 있는 구조

### 4.2 특히 주의할 포인트
- UI와 DB 수량 불일치
- InventoryTx.type(in/out/move/adjust) 혼동
- UNDO 후 재스캔 시 수량 꼬임
- 비프음/경고가 실무 흐름을 방해하는 경우

---

## 5. 환경 전제 (현재)

- 현재는 **로컬 개발/검증 환경**만을 기준으로 한다.
- 운영(Lightsail, 서버, 배포, 백업, 보안) 관점은 기본 전제에 포함하지 않는다.
- 운영 환경 점검은 **사용자가 명시적으로 요청할 때만** 고려한다.

---

## 6. 비용 및 분석 범위 규칙

- 이미 분석한 파일/폴더는 **다시 전체 재분석하지 않는다.**
- "레포 전체 다시 읽기"는 요청이 있을 때만 수행한다.
- 기본 원칙:
  - ❌ 전체 추상 분석
  - ⭕ 특정 기능 / 특정 파일 / 특정 흐름 집중 분석

---

## 7. Claude Code 사용 목적

Claude는 이 레포에서 다음 역할을 수행한다:
- WMS 코드 점검 및 버그 탐지
- 실무 기준 개선 제안
- 코드 직접 수정 (출력 없이)
- 개발자의 '옆자리 동료'처럼 빠르고 실용적인 답변

---

## 8. 요약 (핵심 규칙)

- 한국어
- 코드 출력 없이 직접 수정
- WMS 실무 기준
- 로컬 환경 기준 판단
- 데이터 꼬임 / 되돌릴 수 없는 사고 최우선 차단

이 규칙을 어기면 잘못된 제안으로 간주한다.
