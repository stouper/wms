generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

enum InventoryLogType {
  INIT
  INBOUND
  OUTBOUND
  STORE
  DELIVERY
}

enum JobType {
  STORE
  DELIVERY
}

enum JobStatus {
  READY
  PICKING
  DONE
}

model Inventory {
  id         Int      @id @default(autoincrement())
  sku        String   @unique
  name       String?
  makerCode  String?
  warehouse  String?
  location   String?
  qty        Int      @default(0)
  msrp       Int?
  updatedAt  DateTime @updatedAt

  @@index([warehouse])
  @@index([location])
}

model InventoryLog {
  id         Int               @id @default(autoincrement())
  type       InventoryLogType
  refId      Int?
  sku        String
  diff       Int
  note       String?
  createdAt  DateTime          @default(now())

  @@index([sku, createdAt])
  @@index([type, createdAt])
}

model Job {
  id         Int        @id @default(autoincrement())
  type       JobType
  status     JobStatus  @default(READY)
  orderNo    String?
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt

  items      JobItem[]
}

model JobItem {
  id            Int      @id @default(autoincrement())
  jobId         Int
  sku           String
  requiredQty   Int
  pickedQty     Int      @default(0)

  colH          String?
  colI          String?
  colK          String?

  job           Job      @relation(fields: [jobId], references: [id], onDelete: Cascade)

  @@unique([jobId, sku])
  @@index([sku])
}
